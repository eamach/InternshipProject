package Model.GitlabAutoSAST;

import Model.GitlabAutoSAST.Location.Dependency;
import Model.GitlabAutoSAST.Location.VulnerabilityLocation;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import java.util.ArrayList;
import java.util.List;

import static org.junit.jupiter.api.Assertions.*;

class VulnerabilityTest {

    private Vulnerability v;
    private VulnerabilityScanner vs;
    private VulnerabilityLocation vl;
    private List<VulnerabilityIdentifiers> vi;

    @BeforeEach
    void setUp() {
        vs = new VulnerabilityScanner("0", "scanner");
        vl = new VulnerabilityLocation("file", "0", "0", new Dependency());
        vi = new ArrayList<>();
        v = new Vulnerability("cat", "name", "message", "description", "cve-0000", "LOW", "HIGH", vs, vl, vi);
    }

    @Test
    void getCategory() {
        assertEquals("cat", v.getCategory());
    }

    @Test
    void getName() {
        assertEquals("name", v.getName());
    }

    @Test
    void getMessage() {
        assertEquals("message", v.getMessage());
    }

    @Test
    void getDescription() {
        assertEquals("description", v.getDescription());
    }

    @Test
    void getCve() {
        assertEquals("cve-0000", v.getCve());
    }

    @Test
    void getSeverity() {
        assertEquals("LOW", v.getSeverity());
    }

    @Test
    void getConfidence() {
        assertEquals("HIGH", v.getConfidence());
    }

    @Test
    void getVulnerabilityScanner() {
        assertEquals(vs, v.getVulnerabilityScanner());
    }

    @Test
    void getVulnerabilityLocation() {
        assertEquals(vl, v.getVulnerabilityLocation());
    }

    @Test
    void getVulnerabilityIdentifiers() {
        assertEquals(vi, v.getVulnerabilityIdentifiers());
    }
}